"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),_fs=require("fs"),_fs2=_interopRequireDefault(_fs),_handlebars=require("handlebars"),_handlebars2=_interopRequireDefault(_handlebars),_path=require("path"),_path2=_interopRequireDefault(_path),_mimeJson=require("./mime.json"),_mimeJson2=_interopRequireDefault(_mimeJson),_configJson=require("../config.json"),_configJson2=_interopRequireDefault(_configJson),Mail=function(){function e(t,a,n,r){void 0===n&&(n="(sem assunto)");var s=arguments.length<=4||void 0===arguments[4]?[]:arguments[4],i=arguments.length<=5||void 0===arguments[5]?i||"default":arguments[5];return function(){_classCallCheck(this,e),this.sender=t,this.receivers=a,this.subject=n,this.dataLayer=r,this.template=i+".hbs",this.attachments=s||[]}.apply(this,arguments)}return _createClass(e,[{key:"make",value:function(){var e=_path2["default"].resolve(__dirname,"../templates/"),t=_fs2["default"].readFileSync(_path2["default"].join(e,this.template),"utf-8"),a=_handlebars2["default"].compile(t),n=a(this.dataLayer),r={text:this.dataLayer,from:'"'+_configJson2["default"].sender_name+'" <'+this.sender+">",to:(this.receivers||[]).join(","),subject:this.subject,attachment:[{data:n,alternative:!0}]};return this.attachments.forEach(function(e){var t=e.split("\\");t=t[t.length-1];var a=t.split(".")[1];r.attachment.push({path:e,type:_mimeJson2["default"][a]||"text/plain",name:t})}),r}},{key:"send",value:function(e,t){var a=this.make();e.send(a,function(e,a){"function"==typeof t&&t(e,a)})}}]),e}();exports["default"]=Mail,module.exports=exports["default"];