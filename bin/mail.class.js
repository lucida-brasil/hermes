"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),_fs=require("fs"),_fs2=_interopRequireDefault(_fs),_handlebars=require("handlebars"),_handlebars2=_interopRequireDefault(_handlebars),_path=require("path"),_path2=_interopRequireDefault(_path),_mimeJson=require("./mime.json"),_mimeJson2=_interopRequireDefault(_mimeJson),Mail=function(){function e(t,a,s){var n=arguments.length<=3||void 0===arguments[3]?"(sem assunto)":arguments[3],r=arguments.length<=4||void 0===arguments[4]?[]:arguments[4],i=arguments.length<=5||void 0===arguments[5]?"default":arguments[5];_classCallCheck(this,e),this.sender=t,this.receivers=a,this.subject=n,this.message=s,this.template=i+".hbs",this.attachments=r||[]}return _createClass(e,[{key:"make",value:function(){var e=_path2["default"].resolve(__dirname,"../templates/"),t=_fs2["default"].readFileSync(_path2["default"].join(e,this.template),"utf-8"),a=_handlebars2["default"].compile(t),s=a({message:this.message}),n={text:this.message,from:'"Hermes, O carteiro" <'+this.sender+">",to:(this.receivers||[]).join(","),subject:this.subject,attachment:[{data:s,alternative:!0}]};return this.attachments.forEach(function(e){var t=e.split("\\");t=t[t.length-1];var a=t.split(".")[1];n.attachment.push({path:e,type:_mimeJson2["default"][a]||"text/plain",name:t})}),n}},{key:"send",value:function(e,t){var a=this.make();e.send(a,function(e,a){"function"==typeof t&&t(e,a)})}}]),e}();exports["default"]=Mail,module.exports=exports["default"];